!function(){"use strict";const e={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error-active"};class t{constructor(e,t,n){let{name:s,link:o}=e;this._name=s,this._link=o,this._cardSelector=t,this._handleImageClick=n}_findCardElements(){this._likeButton=this._element.querySelector(".card__like-button"),this._cardImage=this._element.querySelector(".card__image"),this._trashButton=this._element.querySelector(".card__trash-button"),this._card=this._element.querySelector(".card"),this._cardTitle=this._element.querySelector(".card__title")}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon()})),this._trashButton.addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_handleDeleteCard(){this._element.remove(),this._element=null}_handleLikeIcon(){this._likeButton.classList.toggle("card__like-button_active")}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}generateCard(){return this._element=this._getTemplate(),this._findCardElements(),this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardTitle.textContent=this._name,this._element}}class n{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClassSelector=e.inputErrorClassSelector,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClassSelector),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClassSelector),t.textContent=e.validationMessage,t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}toggleButtonState(){this._hasInvalidInput(this._inputElements)?this.disableButton():this._enableButton()}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this.toggleButtonState(),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._formElement.reset()})),this._setEventListeners()}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscKeyPress=this._handleEscKeyPress.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscKeyPress)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscKeyPress)}_handleEscKeyPress(e){"Escape"===e.key&&this.close()}_handleModalOverlay(e){e.target.classList.contains("modal")&&this.close()}setEventListeners(){this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target===this._popupElement&&this.close()}))}}class o extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()}))}}document.querySelector("#card-template").content.firstElementChild;const r=document.forms["profile-form"],i=document.querySelector("#profile-edit-modal"),l=document.querySelector("#profile-edit-button"),a=(i.querySelector("#modal-close-button"),document.querySelector(".profile__title"),r.querySelector("#profile__title-input")),c=(document.querySelector(".profile__description"),r.querySelector("#profile__description-input")),u=(document.querySelector(".modal__input"),document.querySelector("#preview-image-modal")),d=(document.querySelector(".modal__image-preview"),document.querySelector("#modal-title-preview"),u.querySelector("#modal-close-button"),document.querySelector("#new-card-button")),m=document.querySelector("#add-card-modal"),_=document.forms["add-card-form"],p=(m.querySelector("#modal-close-button"),document.querySelector(".cards__list"),document.querySelector(".card__title"),_.querySelector("#add-card-input-title"),document.querySelector(".card__image"),_.querySelector("#add-card-input-url"),new o({popupSelector:"#profile-edit-modal"},(function(e){const t=e.title,n=e.description;console.log(e,t,n),S.setUserInfo(t,n),p.close()})));p.setEventListeners();const h=new o({popupSelector:"#add-card-modal"},(function(e){(function(e){const t=v(e);y.addItem(t)})({name:e.title,link:e.description}),h.close(),q.disableButton()}));h.setEventListeners();const E=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._imageElement=this._popupElement.querySelector(".modal__image-preview"),this._captionElement=this._popupElement.querySelector(".modal__title-preview")}open(e){this._imageElement.src=e.link,this._imageElement.alt=e.name,console.log(e),this._captionElement.textContent=e.name,super.open()}}({popupSelector:"#preview-image-modal"});E.setEventListeners();const S=new class{constructor(e,t){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,description:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}}(".profile__title",".profile__description"),y=new class{constructor(e,t){let{items:n,renderer:s}=e;this._items=n,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=v(e);y.addItem(t)}},".cards__list");function v(e){return new t(e,"#card-template",g).generateCard()}function g(e){E.open({link:e.link,name:e.name})}l.addEventListener("click",(function(){p.open();const e=S.getUserInfo();a.value=e.name,c.value=e.description,f.resetValidation()})),d.addEventListener("click",(()=>h.open())),y.renderItems();const f=new n(e,r);f.enableValidation();const q=new n(e,_);q.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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IndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGFycmF5IGVsZW1lbnRzXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG4vLyBleHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID1cbi8vICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cbi8vIC8vIFByb2ZpbGUgZm9ybSBjb25zdFxuXG4vLyBleHBvcnQgY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtZm9ybVwiXTtcbi8vIGV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG4vLyBleHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG4vLyBleHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4vLyAgIFwiI21vZGFsLWNsb3NlLWJ1dHRvblwiXG4vLyApO1xuLy8gZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG4vLyBleHBvcnQgY29uc3QgbmFtZUlucHV0ID0gcHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX190aXRsZS1pbnB1dFwiKTtcbi8vIGV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuLy8gICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXG4vLyApO1xuLy8gZXhwb3J0IGNvbnN0IGJpb0lucHV0ID0gcHJvZmlsZUZvcm0ucXVlcnlTZWxlY3Rvcihcbi8vICAgXCIjcHJvZmlsZV9fZGVzY3JpcHRpb24taW5wdXRcIlxuLy8gKTtcbi8vIGV4cG9ydCBjb25zdCBmb3JtSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRcIik7XG5cbi8vIC8vIFByZXZpZXcgbW9kYWwgY29uc3RcblxuLy8gZXhwb3J0IGNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbi8vIGV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4vLyAgIFwiLm1vZGFsX19pbWFnZS1wcmV2aWV3XCJcbi8vICk7XG4vLyBleHBvcnQgY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4vLyAgIFwiI21vZGFsLXRpdGxlLXByZXZpZXdcIlxuLy8gKTtcbi8vIGV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ1dHRvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxuLy8gICBcIiNtb2RhbC1jbG9zZS1idXR0b25cIlxuLy8gKTtcblxuLy8gLy8gQWRkIENhcmQgbW9kYWwgY29uc3RcblxuLy8gZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25ldy1jYXJkLWJ1dHRvblwiKTtcbi8vIGV4cG9ydCBjb25zdCBhZGROZXdDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuLy8gZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRGcm9tID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdO1xuLy8gZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRNb2RhbENsb3NlQnV0dG9uID0gYWRkTmV3Q2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4vLyAgIFwiI21vZGFsLWNsb3NlLWJ1dHRvblwiXG4vLyApO1xuLy8gZXhwb3J0IGNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG4vLyBleHBvcnQgY29uc3QgY2FyZFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbi8vIGV4cG9ydCBjb25zdCBhZGROZXdDYXJkSW5wdXRUaXRsZSA9IGFkZE5ld0NhcmRGcm9tLnF1ZXJ5U2VsZWN0b3IoXG4vLyAgIFwiI2FkZC1jYXJkLWlucHV0LXRpdGxlXCJcbi8vICk7XG4vLyBleHBvcnQgY29uc3QgY2FyZEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbi8vIGV4cG9ydCBjb25zdCBhZGROZXdDYXJkSW5wdXRVcmwgPSBhZGROZXdDYXJkRnJvbS5xdWVyeVNlbGVjdG9yKFxuLy8gICBcIiNhZGQtY2FyZC1pbnB1dC11cmxcIlxuLy8gKTtcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3ItYWN0aXZlXCIsXG59O1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgbGluayB9LCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2spIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcblxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgfVxuXG4gIF9maW5kQ2FyZEVsZW1lbnRzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX3RyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jYXJkID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl90cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9oYW5kbGVEZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfaGFuZGxlTGlrZUljb24oKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9maW5kQ2FyZEVsZW1lbnRzKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzc1NlbGVjdG9yID0gY29uZmlnLmlucHV0RXJyb3JDbGFzc1NlbGVjdG9yO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzc1NlbGVjdG9yKTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzU2VsZWN0b3IpO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbGVtZW50cy5ldmVyeShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVsZW1lbnRzKSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gW1xuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcbiAgICBdO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG5cbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjS2V5UHJlc3MgPSB0aGlzLl9oYW5kbGVFc2NLZXlQcmVzcy5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NLZXlQcmVzcyk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NLZXlQcmVzcyk7XG4gIH1cblxuICBfaGFuZGxlRXNjS2V5UHJlc3MoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZU1vZGFsT3ZlcmxheShldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH0pO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBkYXRhID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBkYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgIH0pO1xuICB9XG59XG4iLCIvLyBJbXBvcnRzXG5cbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuaW1wb3J0IFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCBjb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbi8vIENvbnN0YW50c1xuXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cbi8vIFByb2ZpbGUgZm9ybSBjb25zdFxuXG5leHBvcnQgY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtZm9ybVwiXTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI21vZGFsLWNsb3NlLWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gcHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX190aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXG4pO1xuZXhwb3J0IGNvbnN0IGJpb0lucHV0ID0gcHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZV9fZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBmb3JtSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRcIik7XG5cbi8vIFByZXZpZXcgbW9kYWwgY29uc3RcblxuZXhwb3J0IGNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19pbWFnZS1wcmV2aWV3XCJcbik7XG5leHBvcnQgY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI21vZGFsLXRpdGxlLXByZXZpZXdcIlxuKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ1dHRvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNtb2RhbC1jbG9zZS1idXR0b25cIlxuKTtcblxuLy8gQWRkIENhcmQgbW9kYWwgY29uc3RcblxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25ldy1jYXJkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRGcm9tID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdO1xuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRNb2RhbENsb3NlQnV0dG9uID0gYWRkTmV3Q2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI21vZGFsLWNsb3NlLWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5leHBvcnQgY29uc3QgY2FyZFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkSW5wdXRUaXRsZSA9IGFkZE5ld0NhcmRGcm9tLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2FkZC1jYXJkLWlucHV0LXRpdGxlXCJcbik7XG5leHBvcnQgY29uc3QgY2FyZEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkSW5wdXRVcmwgPSBhZGROZXdDYXJkRnJvbS5xdWVyeVNlbGVjdG9yKFxuICBcIiNhZGQtY2FyZC1pbnB1dC11cmxcIlxuKTtcblxuLy8gTmV3IENsYXNzZXNcblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICB7IHBvcHVwU2VsZWN0b3I6IFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiIH0sXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XG4pO1xuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgeyBwb3B1cFNlbGVjdG9yOiBcIiNhZGQtY2FyZC1tb2RhbFwiIH0sXG4gIGhhbmRsZUFkZE5ld0NhcmRTdWJtaXRcbik7XG5uZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaW1hZ2VQcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIsXG59KTtcbmltYWdlUHJldmlld1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX3RpdGxlXCIsIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gZ2VuZXJhdGVDYXJkKGNhcmREYXRhKTtcbiAgICAgIGNhcmRMaXN0LmFkZEl0ZW0oY2FyZCk7XG4gICAgfSxcbiAgfSxcbiAgXCIuY2FyZHNfX2xpc3RcIlxuKTtcblxuLy8gUHJvZmlsZSBFZGl0IE1vZGFsXG5cbmZ1bmN0aW9uIG9wZW5Qcm9maWxlRWRpdE1vZGFsKCkge1xuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcbiAgY29uc3QgY3VycmVudFVzZXJJbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgbmFtZUlucHV0LnZhbHVlID0gY3VycmVudFVzZXJJbmZvLm5hbWU7XG4gIGJpb0lucHV0LnZhbHVlID0gY3VycmVudFVzZXJJbmZvLmRlc2NyaXB0aW9uO1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRzKSB7XG4gIGNvbnN0IG5hbWUgPSBpbnB1dHMudGl0bGU7XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gaW5wdXRzLmRlc2NyaXB0aW9uO1xuICBjb25zb2xlLmxvZyhpbnB1dHMsIG5hbWUsIGRlc2NyaXB0aW9uKTtcbiAgdXNlckluZm8uc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pO1xuICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XG59XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuUHJvZmlsZUVkaXRNb2RhbCk7XG5cbi8vIEFkZCBOZXcgQ2FyZCBNb2RhbFxuXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBuZXdDYXJkUG9wdXAub3BlbigpKTtcbmNhcmRMaXN0LnJlbmRlckl0ZW1zKCk7XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZE5ld0NhcmRTdWJtaXQoaW5wdXRzKSB7XG4gIGNvbnN0IGNhcmREYXRhID0ge1xuICAgIG5hbWU6IGlucHV0cy50aXRsZSxcbiAgICBsaW5rOiBpbnB1dHMuZGVzY3JpcHRpb24sXG4gIH07XG5cbiAgY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIG5ld0NhcmRQb3B1cC5jbG9zZSgpO1xuICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgLy8gdGhhbmtzXG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlUHJldmlld01vZGFsKTtcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZW5lcmF0ZUNhcmQoY2FyZERhdGEpO1xuICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbn1cblxuLy8gZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRWxlbWVudCwgbWV0aG9kID0gXCJwcmVwZW5kXCIpIHtcbi8vICAgY2FyZHNMaXN0W21ldGhvZF0oY2FyZEVsZW1lbnQpO1xuLy8gfVxuXG5mdW5jdGlvbiBoYW5kbGVQcmV2aWV3TW9kYWwoZGF0YSkge1xuICBpbWFnZVByZXZpZXdQb3B1cC5vcGVuKHtcbiAgICBsaW5rOiBkYXRhLmxpbmssXG4gICAgbmFtZTogZGF0YS5uYW1lLFxuICB9KTtcbn1cblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVGb3JtKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYWRkTmV3Q2FyZEZyb20pO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIC8vIEZvcm0gVmFsaWF0aW9uXG5cbi8vIC8vIGRlZmluZSBhbiBvYmplY3QgZm9yIHN0b3JpbmcgdmFsaWRhdG9yc1xuLy8gY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcblxuLy8gY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbi8vICAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xuLy8gICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuLy8gICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xuLy8gICAgIC8vIEhlcmUgeW91IGdldCB0aGUgbmFtZSBvZiB0aGUgZm9ybSAoaWYgeW91IGRvbuKAmXQgaGF2ZSBpdCB0aGVuIHlvdSBuZWVkIHRvIGFkZCBpdCBpbnRvIGVhY2ggZm9ybSBpbiBgaW5kZXguaHRtbGAgZmlyc3QpXG4vLyAgICAgY29uc3QgcHJvZmlsZUZvcm0gPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJwcm9maWxlLWZvcm1cIik7XG4vLyAgICAgY29uc3QgYWRkTmV3Q2FyZEZyb20gPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJhZGQtY2FyZC1mb3JtXCIpO1xuXG4vLyAgICAgLy8gSGVyZSB5b3Ugc3RvcmUgdGhlIHZhbGlkYXRvciB1c2luZyB0aGUgYG5hbWVgIG9mIHRoZSBmb3JtXG4vLyAgICAgZm9ybVZhbGlkYXRvcnNbcHJvZmlsZUZvcm1dID0gdmFsaWRhdG9yO1xuLy8gICAgIGZvcm1WYWxpZGF0b3JzW2FkZE5ld0NhcmRGcm9tXSA9IHZhbGlkYXRvcjtcblxuLy8gICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4vLyAgIH0pO1xuLy8gfTtcblxuLy8gZW5hYmxlVmFsaWRhdGlvbihjb25maWcpO1xuXG4vLyBmb3JtVmFsaWRhdG9yc1twcm9maWxlRm9ybS5nZXRBdHRyaWJ1dGUoXCJwcm9maWxlLWZvcm1cIildLnJlc2V0VmFsaWRhdGlvbigpO1xuLy8gZm9ybVZhbGlkYXRvcnNbcHJvZmlsZUZvcm0uZ2V0QXR0cmlidXRlKFwiYWRkLWNhcmQtZm9ybVwiKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG5cbi8vIC8vIG9yIHlvdSBjYW4gdXNlIGEgc3RyaW5nIOKAkyB0aGUgbmFtZSBvZiB0aGUgZm9ybSAoeW91IGtub3cgaXQgZnJvbSBgaW5kZXguaHRtbGApXG5cbi8vIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuLy8gZm9ybVZhbGlkYXRvcnNbXCJhZGQtY2FyZC1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19pbWFnZS1wcmV2aWV3XCJcbiAgICApO1xuICAgIHRoaXMuX2NhcHRpb25FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fdGl0bGUtcHJldmlld1wiXG4gICAgKTtcbiAgfVxuXG4gIG9wZW4oZGF0YSkge1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IGRhdGEubmFtZTtcbiAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICB0aGlzLl9jYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZUVsZW1lbnQsIGpvYkVsZW1lbnQpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZUVsZW1lbnQpO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYkVsZW1lbnQpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtcykgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbXMpO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjb25maWciLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9maW5kQ2FyZEVsZW1lbnRzIiwiX2xpa2VCdXR0b24iLCJfZWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfY2FyZEltYWdlIiwiX3RyYXNoQnV0dG9uIiwiX2NhcmQiLCJfY2FyZFRpdGxlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwicmVtb3ZlIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2dldFRlbXBsYXRlIiwiX2NhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzc1NlbGVjdG9yIiwiaW5wdXRFcnJvckNsYXNzU2VsZWN0b3IiLCJfZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJpZCIsImFkZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxlbWVudHMiLCJldmVyeSIsImRpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImV2ZW50IiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0tleVByZXNzIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJfaGFuZGxlTW9kYWxPdmVybGF5IiwidGFyZ2V0IiwiY29udGFpbnMiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwiX2dldElucHV0VmFsdWVzIiwiZGF0YSIsImlucHV0IiwidmFsdWUiLCJldnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZUVkaXRCdXR0b24iLCJuYW1lSW5wdXQiLCJiaW9JbnB1dCIsInByZXZpZXdNb2RhbCIsImFkZE5ld0NhcmRCdXR0b24iLCJhZGROZXdDYXJkTW9kYWwiLCJhZGROZXdDYXJkRnJvbSIsImVkaXRQcm9maWxlUG9wdXAiLCJpbnB1dHMiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiY29uc29sZSIsImxvZyIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJuZXdDYXJkUG9wdXAiLCJjYXJkRGF0YSIsImNhcmRFbGVtZW50IiwiY2FyZExpc3QiLCJhZGRJdGVtIiwiY3JlYXRlQ2FyZCIsImFkZEZvcm1WYWxpZGF0b3IiLCJpbWFnZVByZXZpZXdQb3B1cCIsIl9pbWFnZUVsZW1lbnQiLCJfY2FwdGlvbkVsZW1lbnQiLCJuYW1lRWxlbWVudCIsImpvYkVsZW1lbnQiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsImdldFVzZXJJbmZvIiwiY29udGFpbmVyIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJwcmVwZW5kIiwiY2FyZCIsImhhbmRsZVByZXZpZXdNb2RhbCIsImN1cnJlbnRVc2VySW5mbyIsImVkaXRGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==